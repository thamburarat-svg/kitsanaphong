<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>แดชบอร์ดพฤติกรรมผู้บริโภค</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- ฟอนต์ -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
  <style>
    body { font-family: 'Inter', sans-serif; background: #f6f7fb; }
    .data-table-container { max-height: 600px; overflow-y: auto; }
    .data-table { width: 100%; border-collapse: collapse; }
    .data-table th, .data-table td { border-bottom: 1px solid #e5e7eb; }
    .skeleton {
      position: relative; overflow: hidden; background: #e5e7eb;
    }
    .skeleton::after {
      content: ""; position: absolute; inset: 0;
      transform: translateX(-100%);
      background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,.6) 50%, rgba(255,255,255,0) 100%);
      animation: shimmer 1.5s infinite;
    }
    @keyframes shimmer { 100% { transform: translateX(100%); } }
  </style>
</head>

<body class="p-4 md:p-8">
  <div class="max-w-7xl mx-auto">
    <!-- Header -->
    <header class="mb-8">
      <div class="rounded-3xl bg-gradient-to-r from-indigo-600 via-violet-600 to-fuchsia-600 text-white p-6 md:p-8 shadow-lg">
        <h1 class="text-2xl md:text-4xl font-extrabold tracking-tight">แดชบอร์ดพฤติกรรมผู้บริโภค</h1>
        <p class="mt-2 text-white/90">สรุปภาพรวมผู้ใช้งาน แพลตฟอร์มที่นิยม และระดับความพึงพอใจ</p>
      </div>
    </header>

    <!-- Cards -->
    <section class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
      <div class="bg-white p-6 rounded-2xl shadow-lg ring-1 ring-black/5 transition hover:shadow-xl">
        <div class="flex items-center justify-between">
          <h2 class="text-sm font-semibold text-gray-500">จำนวนผู้ใช้งานทั้งหมด</h2>
          <span class="inline-flex items-center justify-center w-10 h-10 rounded-xl bg-indigo-50 text-indigo-600">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
            </svg>
          </span>
        </div>
        <p id="total-users" class="text-4xl md:text-5xl font-extrabold text-gray-900 mt-3 skeleton h-12 w-40 rounded-lg"></p>
        <p class="text-xs text-gray-500 mt-2">รวมจากข้อมูลในชีตล่าสุด</p>
      </div>

      <div class="bg-white p-6 rounded-2xl shadow-lg ring-1 ring-black/5 transition hover:shadow-xl">
        <div class="flex items-center justify-between">
          <h2 class="text-sm font-semibold text-gray-500">คะแนนความพึงพอใจเฉลี่ย</h2>
          <span class="inline-flex items-center justify-center w-10 h-10 rounded-xl bg-emerald-50 text-emerald-600">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4.5 12.75l6 6 9-13.5"/>
            </svg>
          </span>
        </div>
        <p id="avg-satisfaction" class="text-4xl md:text-5xl font-extrabold text-gray-900 mt-3 skeleton h-12 w-40 rounded-lg"></p>
        <p class="text-xs text-gray-500 mt-2">0–5 คะแนน</p>
      </div>
    </section>

    <!-- Chart -->
    <section class="bg-white p-6 rounded-2xl shadow-lg ring-1 ring-black/5 mb-8">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-base md:text-lg font-semibold text-gray-700">จำนวนผู้ใช้งานในแต่ละแพลตฟอร์ม</h2>
        <div id="chart-legend" class="text-xs text-gray-500"></div>
      </div>
      <div class="relative h-80 md:h-96">
        <canvas id="platform-chart"></canvas>
      </div>
    </section>

    <!-- Table & Filters -->
    <section class="bg-white p-6 rounded-2xl shadow-lg ring-1 ring-black/5">
      <div class="flex flex-col md:flex-row md:items-center gap-3 md:gap-4 mb-4">
        <!-- Search -->
        <div class="relative w-full md:w-1/2">
          <input id="searchInput" type="text" placeholder="ค้นหา (เช่น จังหวัด, แพลตฟอร์ม, การศึกษา...)" class="w-full pl-11 pr-3 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:outline-none" />
          <svg class="w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 21l-4.35-4.35M11 19a8 8 0 100-16 8 8 0 000 16z"/></svg>
        </div>

        <!-- Gender -->
        <div class="relative w-full md:w-auto">
          <select id="genderFilter" class="w-full md:w-auto pl-10 pr-9 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-indigo-500 appearance-none">
            <option value="">กรองตามเพศ</option>
            <option value="Male">ชาย</option>
            <option value="Female">หญิง</option>
          </select>
          <svg class="w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
          <svg class="w-4 h-4 text-gray-400 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 9l6 6 6-6"/></svg>
        </div>

        <!-- Income -->
        <div class="relative w-full md:w-auto">
          <select id="incomeFilter" class="w-full md:w-auto pl-10 pr-9 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-indigo-500 appearance-none">
            <option value="">กรองตามรายได้</option>
            <option value="Low">ต่ำ</option>
            <option value="Medium">ปานกลาง</option>
            <option value="High">สูง</option>
          </select>
          <svg class="w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8c-2.21 0-4 .9-4 2s1.79 2 4 2 4 .9 4 2-1.79 2-4 2m0-10v2m0 10v2"/></svg>
          <svg class="w-4 h-4 text-gray-400 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 9l6 6 6-6"/></svg>
        </div>

        <button id="clearFilters" class="px-4 py-3 rounded-xl bg-gray-100 hover:bg-gray-200 text-gray-700 inline-flex items-center gap-2">
          <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 21l6-6m0 0l3 3m-3-3l6-6a3 3 0 114.243 4.243L12.243 18M3 21h6"/></svg>
          ล้างตัวกรอง
        </button>
        <span id="resultCount" class="md:ml-auto text-sm text-gray-500"></span>
      </div>

      <div class="data-table-container rounded-xl border border-gray-200">
        <div id="loadingMessage" class="p-6 text-center text-gray-500">
          <div class="mx-auto w-24 h-2 rounded-full bg-gray-200 overflow-hidden">
            <div class="h-full w-1/2 bg-indigo-500 animate-pulse"></div>
          </div>
          <p class="mt-3">กำลังโหลดข้อมูล... โปรดรอสักครู่</p>
        </div>

        <table id="dataTable" class="data-table hidden">
          <thead class="bg-gray-50 sticky top-0 z-10">
            <tr class="text-left text-sm text-gray-600">
              <th data-key="customer_id" class="px-4 py-3 cursor-pointer select-none group"><span class="inline-flex items-center gap-1">ID<svg class="w-3 h-3 text-gray-300 group-hover:text-gray-400 inline-block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 8l4-4 4 4M6 12l4 4 4-4"/></svg></span></th>
              <th data-key="age" class="px-4 py-3 cursor-pointer select-none group"><span class="inline-flex items-center gap-1">อายุ<svg class="w-3 h-3 text-gray-300 group-hover:text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 8l4-4 4 4M6 12l4 4 4-4"/></svg></span></th>
              <th data-key="gender" class="px-4 py-3 cursor-pointer select-none group"><span class="inline-flex items-center gap-1">เพศ<svg class="w-3 h-3 text-gray-300 group-hover:text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 8l4-4 4 4M6 12l4 4 4-4"/></svg></span></th>
              <th data-key="income_level" class="px-4 py-3 cursor-pointer select-none group"><span class="inline-flex items-center gap-1">ระดับรายได้<svg class="w-3 h-3 text-gray-300 group-hover:text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 8l4-4 4 4M6 12l4 4 4-4"/></svg></span></th>
              <th data-key="education" class="px-4 py-3 cursor-pointer select-none group"><span class="inline-flex items-center gap-1">การศึกษา<svg class="w-3 h-3 text-gray-300 group-hover:text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 8l4-4 4 4M6 12l4 4 4-4"/></svg></span></th>
              <th data-key="location" class="px-4 py-3 cursor-pointer select-none group"><span class="inline-flex items-center gap-1">ที่ตั้ง<svg class="w-3 h-3 text-gray-300 group-hover:text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 8l4-4 4 4M6 12l4 4 4-4"/></svg></span></th>
              <th data-key="preferred_platform" class="px-4 py-3 cursor-pointer select-none group"><span class="inline-flex items-center gap-1">แพลตฟอร์มที่ชอบ<svg class="w-3 h-3 text-gray-300 group-hover:text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 8l4-4 4 4M6 12l4 4 4-4"/></svg></span></th>
              <th data-key="satisfaction_score" class="px-4 py-3 cursor-pointer select-none group"><span class="inline-flex items-center gap-1">คะแนนความพึงพอใจ<svg class="w-3 h-3 text-gray-300 group-hover:text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 8l4-4 4 4M6 12l4 4 4-4"/></svg></span></th>
            </tr>
          </thead>
          <tbody class="text-sm text-gray-800">
            <!-- JS fill -->
          </tbody>
        </table>

        <div id="emptyState" class="hidden p-8 text-center text-gray-500">
          <p class="text-lg font-medium">ไม่พบข้อมูลที่ตรงกับตัวกรอง</p>
          <p class="text-sm mt-1">ลองเปลี่ยนคำค้นหาหรือกด “ล้างตัวกรอง”</p>
        </div>
      </div>

      <div class="flex items-center justify-between mt-4">
        <div class="text-sm text-gray-500">แสดง <span id="pageFrom">0</span>–<span id="pageTo">0</span> จากทั้งหมด <span id="pageTotal">0</span> รายการ</div>
        <div class="flex gap-2">
          <button id="prevPage" class="px-3 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 disabled:opacity-40">ก่อนหน้า</button>
          <
